<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.tracom.mapper.SI0405.SI0405Mapper">

<select id="SI0405G0R0" resultType="Map">
	SELECT ROUT_GRP, ROUT_GRP_NM, ROUT_TYPE, ROUT_DIV, ST_STTN_ID,
		(SELECT STTN_NM FROM BMS_STTN_MST WHERE STTN_ID = ST_STTN_ID AND DEL_YN!='Y') ST_STTN_NM,
		(SELECT STTN_ENM FROM BMS_STTN_MST WHERE STTN_ID = ST_STTN_ID AND DEL_YN!='Y') ST_STTN_ENM,
		ED_STTN_ID,
		(SELECT STTN_NM FROM BMS_STTN_MST WHERE STTN_ID = ED_STTN_ID AND DEL_YN!='Y') ED_STTN_NM,
		(SELECT STTN_ENM FROM BMS_STTN_MST WHERE STTN_ID = ED_STTN_ID AND DEL_YN!='Y') ED_STTN_ENM,
		AREA, WAY_YN, WAY_ASC_NM, WAY_DESC_NM, HOLI_YN, USE_YN, REMARK
	FROM BMS_ROUT_GRP_MST
	WHERE DEL_YN = 'N'
		<if test="CONTENT != null and CONTENT != ''">
			AND ROUT_GRP LIKE CONCAT('%',#{CONTENT},'%') || ROUT_GRP_NM LIKE CONCAT('%',#{CONTENT},'%') 
		</if>
		<if test="TYPE == 'ROUT_GRP'">
			AND ROUT_GRP LIKE CONCAT('%',#{CONTENT},'%')
		</if>
		<if test="TYPE == 'ROUT_GRP_NM'">
			AND ROUT_GRP_NM LIKE CONCAT('%',#{CONTENT},'%') 
		</if>
		<if test="USE_YN != null and USE_YN != ''">
			AND USE_YN = #{USE_YN}
		</if>
</select>

<select id="SI0405SHI0" resultType="Map">
	SELECT 	ROUT_GRP, ROUT_GRP_NM
	FROM BMS_ROUT_GRP_MST
	WHERE	DEL_YN = 'N'
</select>

<select id="SI0405G0K0" resultType="Map">
	SELECT CONCAT('RR', LPAD(NEXTVAL(SEQ_BMS_ROUT_GRP_MST_0), 8, '0')) AS 'SEQ'
</select>

<insert id="SI0405G0I0" parameterType="Map">
	INSERT INTO BMS_ROUT_GRP_MST
			(
			ROUT_GRP,
			ROUT_GRP_NM,
			ROUT_TYPE,
			ROUT_DIV,
			AREA,
			ST_STTN_ID,
			ED_STTN_ID,
			WAY_YN,
			WAY_ASC_NM,
			WAY_DESC_NM,
			HOLI_YN,
			USE_YN,
			REMARK,
			UPD_DTM,
			UPD_ID
			)
	
	VALUES		
			(
			#{ROUT_GRP},
			#{ROUT_GRP_NM},
			#{ROUT_TYPE},
			#{ROUT_DIV},
			#{AREA},
			#{ST_STTN_ID},
			#{ED_STTN_ID},
			#{WAY_YN},
			#{WAY_ASC_NM},
			#{WAY_DESC_NM},
			#{HOLI_YN},
			#{USE_YN},
			#{REMARK},
			#{UPD_DTM},
			#{SSN_USER_ID}
			)				
</insert>

<update id="SI0405G0U0" parameterType="Map">
	UPDATE BMS_ROUT_GRP_MST
	SET 	ROUT_GRP_NM = #{ROUT_GRP_NM},
			ROUT_TYPE = #{ROUT_TYPE},
			ROUT_DIV = #{ROUT_DIV},
			AREA = #{AREA},
			ST_STTN_ID = #{ST_STTN_ID},
			ED_STTN_ID = #{ED_STTN_ID},
			WAY_YN = #{WAY_YN},
			WAY_ASC_NM = #{WAY_ASC_NM},
			WAY_DESC_NM = #{WAY_DESC_NM},
			HOLI_YN = #{HOLI_YN},
			USE_YN = #{USE_YN},
			REMARK = #{REMARK},
			UPD_DTM = #{UPD_DTM},
			UPD_ID  = #{SSN_USER_ID}
	WHERE ROUT_GRP = #{ROUT_GRP}
</update>

<delete id="SI0405G0D0" parameterType="Map">
	UPDATE BMS_ROUT_GRP_MST
	SET	DEL_YN = 'Y', USE_YN = 'N'
	WHERE ROUT_GRP = #{ROUT_GRP}
	<!-- DELETE FROM BMS_ROUT_GRP_MST
	WHERE ROUT_GRP = #{ROUT_GRP} -->
</delete>

</mapper>